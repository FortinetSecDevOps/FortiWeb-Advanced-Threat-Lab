## [DEFENSE]

### Biometrics based bot detection:



Now let’s see how FortiWeb will protect the Juice shop from the Bot you ran during the attack module.

1) Create a Biometrics based Bot detection by clicking create new as shown below:

![Graphical user interface, text, application  Description automatically generated](file:////Users/sallam/Library/Group%20Containers/UBF8T346G9.Office/TemporaryItems/msohtmlclip/clip_image001.png)

 

2. We can monitor for Various client events as shown below. However lets uncheck the default values and only select Screen Touch for now. 

​        Also change the event collection period to 10 seconds. Fortiweb will	             		monitor the client activities for 10 seconds before it confirms the client is 		a bot. 

​		Click OK.

![Graphical user interface, application  Description automatically generated](file:////Users/sallam/Library/Group%20Containers/UBF8T346G9.Office/TemporaryItems/msohtmlclip/clip_image002.png)

3) Click Create New for the URL Fortiweb will monitor these events on. 

![Graphical user interface, application, Word  Description automatically generated](file:////Users/sallam/Library/Group%20Containers/UBF8T346G9.Office/TemporaryItems/msohtmlclip/clip_image003.png)

 

4) Select Regular expression, and **.\*** to match all the URL’s. 

​		Click OK.

![Graphical user interface, application, Word  Description automatically generated](file:////Users/sallam/Library/Group%20Containers/UBF8T346G9.Office/TemporaryItems/msohtmlclip/clip_image004.png)

5) Now Let’s create a Bot Mitigation Policy and attach the Bio metrics-based bot detection rule which we created in the earlier step. 

![Graphical user interface, text, application, Word  Description automatically generated](file:////Users/sallam/Library/Group%20Containers/UBF8T346G9.Office/TemporaryItems/msohtmlclip/clip_image005.png)



![Graphical user interface, text, application  Description automatically generated](file:////Users/sallam/Library/Group%20Containers/UBF8T346G9.Office/TemporaryItems/msohtmlclip/clip_image006.png)

6) To apply this to the Juice Shop protection profile, Navigate to Policy >> Web protection profile >> click the juiceshop profile we create earlier. 

![Graphical user interface, application, table  Description automatically generated](file:////Users/sallam/Library/Group%20Containers/UBF8T346G9.Office/TemporaryItems/msohtmlclip/clip_image007.png)
 

7. Scroll to Bot Mitigation and assign the policy we created in Step 5. 

​		Click OK.

![Graphical user interface, application  Description automatically generated](file:////Users/sallam/Library/Group%20Containers/UBF8T346G9.Office/TemporaryItems/msohtmlclip/clip_image008.png)

8. Repeat the same steps from attack lab to run the bot again:

​		After 10 seconds the bot will crash with a crash log on the terminal. 

![Graphical user interface, text  Description automatically generated](file:////Users/sallam/Library/Group%20Containers/UBF8T346G9.Office/TemporaryItems/msohtmlclip/clip_image009.png)

9. On Fortiweb if you go to Log >> log and report >> attack log: 

​		You should see an attack log generated for Biometrics based bot 		detection. 

![Graphical user interface, text, application, Word, email  Description automatically generated](file:////Users/sallam/Library/Group%20Containers/UBF8T346G9.Office/TemporaryItems/msohtmlclip/clip_image010.png)

 

10. Double click on the log to see a Message with the explanation.

![Graphical user interface, text, application, email  Description automatically generated](file:////Users/sallam/Library/Group%20Containers/UBF8T346G9.Office/TemporaryItems/msohtmlclip/clip_image011.png) 

That concludes the Biometrics based bot detection lab. 

